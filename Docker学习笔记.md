# Docker学习笔记

## 容器演变过程

### 最早程序发布过程

发布程序：

1. 购物物理服务器
2. 将程序文件拷贝到物理服务器中

存在的缺点：

1. 部署非常慢
2. 成本高
3. 资源浪费
4. 难于迁移和扩展
5. 受硬件限制

### 虚拟化技术出现以后

实施方式：

1. 一个物理机可以划分多个虚拟机(Virtual Machines，简称VM)
2. 每个程序独立运行在各自的虚拟机里

虚拟化的有点：

1. 资源池：一个物理机的资源可以分配到不同的虚拟机里
2. 容易扩展：加物理机器或加虚拟机
3. 容易云化：例如 阿里云 腾讯云

### 虚拟化的局限性

1. 每个虚拟机都是一个完整的操作系统，要给其分配资源，操作系统本身消耗资源

### 开发和运维面临的问题

1. 开发人员有一套开发流程和所需环境：开发语言、数据库、数据监控等
2. 运维人员有一套运维流程和服务器环境：程序部署、服务监控等

以上情况造成开发人员和运维人员没有统一有效的沟通方式(中介)、一个标准、一个模式，这就造成开发人员部署软件时与服务器环境不一致。

### 容器解决了什么问题

容器是一个中间容器，相当于一个桥梁，解决了开发环境和运维环境之间的差异矛盾。

Docker 图标为一个集装箱，含义是：开发和运维环境都以“集装箱”为单位进行文件数据传递，至于集装箱中放的是什么内容，运维人员不用关心。

> Docker进行了拟物化，用集装箱来表示容器。

### 什么容器？

1. 对软件和其依赖的标注打包
2. 应用之间相互隔离(当然肯定没有虚拟机隔离程度好)
3. 共享一个OS Kernel
4. 可以运行在很多主流操作系统中

### 容器和虚拟机的区别

1. 容器是APP程序层面的隔离
2. 虚拟化是物理资源层面的隔离
3. 在腾讯云服务器上使用容器(Docker)，相当于 虚拟化+容器

### 容器技术的实现

1. Docker 仅仅是容器技术的一种实现
2. 还有其他容器技术
3. 只不过目前Docker最流行
4. Docker也分为免费社区版和收费企业版

## Docker安装

### Win10安装Docker桌面版

**首先强调一下，Docker Desktop (桌面版) 只支持 win10 系统。**

> 因为 Docker 本质上是一个 Linux 程序，所谓 Docker桌面版 其实是一个 Docker 官方制作的具有虚拟机性质的外壳。
> 而只有 win10 系统才开始支持 WSL 2 Linux 内核模块。

#### 第1步：下载安装包

下载地址：https://www.docker.com/get-started  点击 Download for Windows

目前最新版本为：2.3.0.3

#### 第2步：解决Windows系统低版本无法安装的问题

当准备安装 Docker Desktop Installer.exe 时，默认会安装程序会先检测当前 windows 系统版本，我这里收到的提示为：

```
Docker Desktop requires Windows 10 Pro/Enterprise (15063+) or Windows 10 Home (19018+).
```

无法安装，默认要求 win10 专业版(15063+) 或 win10 家庭版(19018+)

> 总不至于为了安装 docker 要更换操作系统吧，别急，有以下几种解决方案。

#### 解决方式1：升级系统

如果你电脑是 win10 以下的系统，那么除非更换操作系统，否则不能靠简单的系统更新来完成大的版本号升级。

我的电脑当前是 windows 10 家庭版 1903，所以在不更换操作系统情况下，是可以通过升级来达到 Docker  要求的。

**不可用的升级方式：**

```
设置 > 更新与安全 > windows 更新
```

这种更新只会做小版本的升级变动，我的电脑检测最多可以升级到 1909，依然达不到 Docker 家庭版最低 19018 的要求。

**正确的升级方式：**

到微软官网，下载 windows10 专属升级工具 “易升”，下载地址：https://www.microsoft.com/en-gb/software-download/windows10 ，点击下载网页中按钮 “Update now”，下载完成后，安装该程序，并根据提示升级操作系统。

> 我的电脑系统升级之后为版本号为 2004，已可以正常安装 Docker Desktop 版本

**更新 WSL 2 Linux 内核**

首次运行 Docker 桌面版，提示需要更新 系统 WSL 2 Linux内核，更新下载地址：https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-kernel ，安装更新并重启电脑，即可开始正常使用 Docker 桌面版。

#### 解决方式2：修改系统文件，欺骗 Docker 检测工具

具体方法，请参阅：https://itnext.io/install-docker-on-windows-10-home-d8e621997c1d

> 个人不推荐如此操作，不确定会有什么隐患。



### Win10以下版本安装Docker

#### 第1种方式：安装 DockerToolbox

放弃安装 Docker for Windows，该用安装 Docker Toolbox。
下载地址：https://github.com/docker/toolbox/releases  在页面 Assets 中找到 DockerToolbox-xx.xx.x.exe
目前最新版本为：19.03.1

尽管 DockerToolbox 依然由 Docker 官方维护，但已被官方“遗弃”，官方不推荐继续使用 DockerToolbox。

#### 第2种方式：安装Linux虚拟机

安装 Linux 虚拟机，然后在虚拟机中安装 Docker。



### CentOS安装Docker

